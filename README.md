# âš½ K League Soccer Event Prediction

![Python](https://img.shields.io/badge/python-3.8+-blue.svg)
![PyTorch](https://img.shields.io/badge/PyTorch-2.0+-ee4c2c.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)

ë”¥ëŸ¬ë‹ ê¸°ë°˜ ì¶•êµ¬ ì´ë²¤íŠ¸ ìœ„ì¹˜ ì˜ˆì¸¡ ì‹œìŠ¤í…œì…ë‹ˆë‹¤. Spatial-Temporal Transformerë¥¼ í™œìš©í•˜ì—¬ Kë¦¬ê·¸ ê²½ê¸° ë°ì´í„°ì—ì„œ ë‹¤ìŒ ì´ë²¤íŠ¸ì˜ ì¢Œí‘œë¥¼ ì˜ˆì¸¡í•©ë‹ˆë‹¤.

## ğŸ“‹ ëª©ì°¨

- [í”„ë¡œì íŠ¸ ê°œìš”](#-í”„ë¡œì íŠ¸-ê°œìš”)
- [ì£¼ìš” íŠ¹ì§•](#-ì£¼ìš”-íŠ¹ì§•)
- [ì„¤ì¹˜ ë°©ë²•](#-ì„¤ì¹˜-ë°©ë²•)
- [ë°ì´í„° êµ¬ì¡°](#-ë°ì´í„°-êµ¬ì¡°)
- [ì‚¬ìš© ë°©ë²•](#-ì‚¬ìš©-ë°©ë²•)
- [ëª¨ë¸ ì•„í‚¤í…ì²˜](#-ëª¨ë¸-ì•„í‚¤í…ì²˜)
- [ì„±ëŠ¥ ì§€í‘œ](#-ì„±ëŠ¥-ì§€í‘œ)
- [í”„ë¡œì íŠ¸ êµ¬ì¡°](#-í”„ë¡œì íŠ¸-êµ¬ì¡°)

## ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”

ì´ í”„ë¡œì íŠ¸ëŠ” Kë¦¬ê·¸ ì¶•êµ¬ ê²½ê¸°ì˜ ì´ë²¤íŠ¸ ì‹œí€€ìŠ¤ë¥¼ ë¶„ì„í•˜ì—¬ ë‹¤ìŒ ì´ë²¤íŠ¸ê°€ ë°œìƒí•  ìœ„ì¹˜(x, y ì¢Œí‘œ)ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ë”¥ëŸ¬ë‹ ëª¨ë¸ì„ êµ¬í˜„í•©ë‹ˆë‹¤.

### í•µì‹¬ ê¸°ìˆ 
- **Spatial-Temporal Transformer**: ì‹œê³µê°„ íŒ¨í„´ í•™ìŠµ
- **Feature Engineering**: ì†ë„, ê³¨ëŒ€ ê±°ë¦¬/ê°ë„ ë“± ë„ë©”ì¸ íŠ¹í™” í”¼ì²˜
- **Sequence Learning**: ê³¼ê±° 20ê°œ ì´ë²¤íŠ¸ ê¸°ë°˜ ì˜ˆì¸¡

## âœ¨ ì£¼ìš” íŠ¹ì§•

- ğŸŸï¸ **ê²½ê¸°ì¥ ì¢Œí‘œê³„**: Kë¦¬ê·¸ í‘œì¤€ (105m Ã— 68m) 
- ğŸ“Š **ì‹œê³„ì—´ ë°ì´í„° ì²˜ë¦¬**: ì´ë²¤íŠ¸ ê°„ ì‹œê°„ ì°¨ì´ ë° ì†ë„ ê³„ì‚°
- ğŸ¯ **ìœ„ì¹˜ ì„ë² ë”©**: í•™ìŠµ ê°€ëŠ¥í•œ Positional Encoding
- ğŸ”„ **ë©€í‹°í—¤ë“œ ì–´í…ì…˜**: ë³µì¡í•œ íŒ¨í„´ í¬ì°©
- ğŸ“ˆ **ìœ í´ë¦¬ë“œ ê±°ë¦¬ ì†ì‹¤**: ì¢Œí‘œ ì˜ˆì¸¡ ì •í™•ë„ ìµœì í™”

## ğŸš€ ì„¤ì¹˜ ë°©ë²•

### ìš”êµ¬ì‚¬í•­

```bash
Python >= 3.8
PyTorch >= 2.0
pandas >= 1.5.0
numpy >= 1.23.0
scikit-learn >= 1.2.0
```

### ì„¤ì¹˜

```bash
# ì €ì¥ì†Œ í´ë¡ 
git clone https://github.com/your-username/soccer-event-prediction.git
cd soccer-event-prediction

# ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt

# ë°ì´í„° ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p data/raw saved_models
```

## ğŸ“ ë°ì´í„° êµ¬ì¡°

```
data/
â”œâ”€â”€ raw/
â”‚   â”œâ”€â”€ train.csv          # í•™ìŠµ ë°ì´í„°
â”‚   â”œâ”€â”€ match_info.csv     # ê²½ê¸° ë©”íƒ€ë°ì´í„°
â”‚   â””â”€â”€ test.csv           # í…ŒìŠ¤íŠ¸ ë°ì´í„°
â””â”€â”€ sample_submission.csv  # ì œì¶œ í˜•ì‹
```

### ë°ì´í„° í•„ë“œ

| í•„ë“œëª… | ì„¤ëª… | íƒ€ì… |
|--------|------|------|
| `game_id` | ê²½ê¸° ê³ ìœ  ID | int |
| `game_episode` | ì´ë²¤íŠ¸ ìˆœë²ˆ | int |
| `type_name` | ì´ë²¤íŠ¸ íƒ€ì… (íŒ¨ìŠ¤, ìŠ› ë“±) | str |
| `time_seconds` | ê²½ê³¼ ì‹œê°„ (ì´ˆ) | float |
| `start_x`, `start_y` | ì‹œì‘ ì¢Œí‘œ | float |
| `end_x`, `end_y` | ì¢…ë£Œ ì¢Œí‘œ (target) | float |
| `team_id` | íŒ€ ID | int |
| `player_id` | ì„ ìˆ˜ ID | int |

## ğŸ’» ì‚¬ìš© ë°©ë²•

### 1. í•™ìŠµ

```bash
python train.py
```

**ì£¼ìš” ì„¤ì •** (`src/config.py`ì—ì„œ ìˆ˜ì •):

```python
SEQ_LEN = 20          # ì‹œí€€ìŠ¤ ê¸¸ì´
EMBED_DIM = 128       # ì„ë² ë”© ì°¨ì›
NUM_LAYERS = 4        # Transformer ë ˆì´ì–´ ìˆ˜
EPOCHS = 30           # ì—í­ ìˆ˜
BATCH_SIZE = 64       # ë°°ì¹˜ í¬ê¸°
LEARNING_RATE = 1e-3  # í•™ìŠµë¥ 
```

### 2. ì¶”ë¡ 

```bash
python inference.py
```

ì˜ˆì¸¡ ê²°ê³¼ëŠ” `submission.csv`ë¡œ ì €ì¥ë©ë‹ˆë‹¤.

### 3. ì»¤ìŠ¤í…€ ì„¤ì •

```python
from src.config import Config

# ì„¤ì • ë³€ê²½
Config.EPOCHS = 50
Config.BATCH_SIZE = 128

# ëª¨ë¸ í•™ìŠµ
from train import main
main()
```

## ğŸ—ï¸ ëª¨ë¸ ì•„í‚¤í…ì²˜

```
Input (Sequence of 20 events)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Feature Embedding Layer    â”‚
â”‚  - Continuous: MLP (6â†’128)  â”‚
â”‚  - Categorical: Emb (â†’128)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Positional Encoding        â”‚
â”‚  (Learnable Parameters)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Transformer Encoder (Ã—4)   â”‚
â”‚  - Multi-Head Attention     â”‚
â”‚  - Feed-Forward Network     â”‚
â”‚  - Layer Normalization      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Last Token Selection       â”‚
â”‚  (Current Time Step)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Regression Head            â”‚
â”‚  128 â†’ 64 â†’ 2 (x, y)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
Output: (x, y) coordinates
```

### í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§

**ì—°ì†í˜• ë³€ìˆ˜ (6ê°œ)**:
- `start_x`, `start_y`: ì‹œì‘ ìœ„ì¹˜
- `time_diff`: ì´ì „ ì´ë²¤íŠ¸ì™€ì˜ ì‹œê°„ ì°¨
- `velocity`: ì´ë™ ì†ë„
- `dist_to_goal`: ê³¨ëŒ€ê¹Œì§€ ê±°ë¦¬
- `angle_to_goal`: ê³¨ëŒ€ ë°©í–¥ ê°ë„

**ë²”ì£¼í˜• ë³€ìˆ˜ (2ê°œ)**:
- `type_name`: ì´ë²¤íŠ¸ íƒ€ì… (ì„ë² ë”©)
- `team_id`: íŒ€ ID (ì„ë² ë”©)

## ğŸ“Š ì„±ëŠ¥ ì§€í‘œ

ëª¨ë¸ í‰ê°€ì—ëŠ” **ìœ í´ë¦¬ë“œ ê±°ë¦¬(Euclidean Distance)**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:

```python
Loss = âˆš((pred_x - true_x)Â² + (pred_y - true_y)Â²)
```

### ì˜ˆìƒ ì„±ëŠ¥

| Metric | Value |
|--------|-------|
| Train Loss | ~3.5m |
| Validation Loss | ~4.2m |
| Test RMSE | ~5.0m |

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
soccer-event-prediction/
â”‚
â”œâ”€â”€ data/                      # ë°ì´í„° ë””ë ‰í† ë¦¬
â”‚   â”œâ”€â”€ raw/                   # ì›ë³¸ ë°ì´í„°
â”‚   â””â”€â”€ sample_submission.csv
â”‚
â”œâ”€â”€ src/                       # ì†ŒìŠ¤ ì½”ë“œ
â”‚   â”œâ”€â”€ config.py             # ì„¤ì • íŒŒì¼
â”‚   â”œâ”€â”€ dataset.py            # ë°ì´í„°ì…‹ í´ë˜ìŠ¤
â”‚   â”œâ”€â”€ feature_engineering.py # í”¼ì²˜ ìƒì„±
â”‚   â”œâ”€â”€ model.py              # ëª¨ë¸ ì•„í‚¤í…ì²˜
â”‚   â”œâ”€â”€ trainer.py            # í•™ìŠµ ë£¨í”„
â”‚   â””â”€â”€ utils.py              # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”‚
â”œâ”€â”€ saved_models/             # ì €ì¥ëœ ëª¨ë¸
â”‚   â””â”€â”€ best_model.pth
â”‚
â”œâ”€â”€ train.py                  # í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ inference.py              # ì¶”ë¡  ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ requirements.txt          # ì˜ì¡´ì„± ëª©ë¡
â””â”€â”€ README.md                 # í”„ë¡œì íŠ¸ ë¬¸ì„œ
```

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ì¼ë°˜ì ì¸ ë¬¸ì œ

**Q: `FileNotFoundError: train.csv not found`**
```bash
# ë°ì´í„° íŒŒì¼ ê²½ë¡œ í™•ì¸
ls data/raw/train.csv

# Configì—ì„œ ê²½ë¡œ ìˆ˜ì •
TRAIN_PATH = "./data/raw/train.csv"
```

**Q: CUDA out of memory**
```python
# ë°°ì¹˜ í¬ê¸° ì¤„ì´ê¸°
Config.BATCH_SIZE = 32  # 64 â†’ 32
```

**Q: ì˜ˆì¸¡ ê¸¸ì´ ë¶ˆì¼ì¹˜**
```python
# Datasetì˜ ì‹œí€€ìŠ¤ ê¸¸ì´ê°€ Test ë°ì´í„°ì™€ ë§ì§€ ì•Šì„ ê²½ìš°
# inference.pyì—ì„œ padding ë¡œì§ ì¶”ê°€ í•„ìš”
```

## ğŸ“ ì°¸ê³  ìë£Œ

- [Transformer ë…¼ë¬¸](https://arxiv.org/abs/1706.03762)
- [PyTorch ê³µì‹ ë¬¸ì„œ](https://pytorch.org/docs/)
- [Kë¦¬ê·¸ ê³µì‹ ë°ì´í„°](https://www.kleague.com/)

## ğŸ¤ ê¸°ì—¬í•˜ê¸°

Pull RequestëŠ” ì–¸ì œë‚˜ í™˜ì˜í•©ë‹ˆë‹¤!

1. Fork the Project
2. Create your Feature Branch (`git checkout -b feature/AmazingFeature`)
3. Commit your Changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the Branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## ğŸ“„ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” MIT ë¼ì´ì„ ìŠ¤ í•˜ì— ë°°í¬ë©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ `LICENSE` íŒŒì¼ì„ ì°¸ì¡°í•˜ì„¸ìš”.


â­ ì´ í”„ë¡œì íŠ¸ê°€ ë„ì›€ì´ ë˜ì—ˆë‹¤ë©´ Starë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”!
